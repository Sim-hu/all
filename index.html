<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>統合計算ツール</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f0f0f0;
            color: #333;
            transition: background-color 0.3s, color 0.3s;
        }
        body.dark-mode {
            background-color: #333;
            color: #f0f0f0;
        }
        h1, h2 {
            color: #333;
            text-align: center;
        }
        .dark-mode h1, .dark-mode h2 {
            color: #f0f0f0;
        }
        .calculator {
            background-color: #ffffff;
            padding: 20px;
            margin-bottom: 20px;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }
        .dark-mode .calculator {
            background-color: #444;
            box-shadow: 0 0 10px rgba(255,255,255,0.1);
        }
        label {
            display: inline-block;
            width: 200px;
            margin-bottom: 10px;
            color: #555;
        }
        .dark-mode label {
            color: #ccc;
        }
        input, select {
            width: 120px;
            padding: 5px;
            border: 1px solid #ccc;
            border-radius: 5px;
            background-color: #fff;
            color: #333;
        }
        .dark-mode input, .dark-mode select {
            background-color: #555;
            color: #f0f0f0;
            border-color: #777;
        }
        button {
            margin-top: 10px;
            padding: 10px 20px;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        button:hover {
            background-color: #45a049;
        }
        .result {
            margin-top: 20px;
            font-weight: bold;
            color: #333;
            text-align: center;
        }
        .dark-mode .result {
            color: #f0f0f0;
        }
        #pageSelector {
            text-align: center;
            margin-bottom: 20px;
        }
        #pageSelector button {
            margin: 5px;
            padding: 5px 10px;
            background-color: #008CBA;
        }
        #pageSelector button:hover {
            background-color: #007B9A;
        }
        .page {
            display: none;
        }
        .active {
            display: block;
        }
        #darkModeToggle {
            position: absolute;
            top: 10px;
            right: 10px;
        }
        .switch {
            position: relative;
            display: inline-block;
            width: 60px;
            height: 34px;
        }
        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .4s;
            border-radius: 34px;
        }
        .slider:before {
            position: absolute;
            content: "";
            height: 26px;
            width: 26px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }
        input:checked + .slider {
            background-color: #2196F3;
        }
        input:checked + .slider:before {
            transform: translateX(26px);
        }
    </style>
</head>
<body>
    <div id="darkModeToggle">
        <label class="switch">
            <input type="checkbox" id="darkModeSwitch">
            <span class="slider"></span>
        </label>
    </div>

    <div id="pageSelector">
        <button onclick="showPage('cdPage')">CD計算機</button>
        <button onclick="showPage('freecrystalPage')">フリークリスタ計算</button>
        <button onclick="showPage('critsPage')">c率計算機</button>
        <button onclick="showPage('makePage')">マケ計算機</button>
    </div>

    <!-- CD計算機 -->
    <div id="cdPage" class="page">
        <h1>CD計算機</h1>
        <div class="calculator">
            <form>
                <label for="basestr">基礎STR:</label>
                <input type="number" id="basestr" placeholder="0" value="0" required><br>

                <label for="strp">STR%:</label>
                <input type="number" id="strp" placeholder="0" value="0" required><br>

                <label for="addstr">STR+:</label>
                <input type="number" id="addstr" placeholder="0" value="0" required><br>

                <label for="baseagi">基礎AGI:</label>
                <input type="number" id="baseagi" placeholder="0" value="0" required><br>

                <label for="agip">AGI%:</label>
                <input type="number" id="agip" placeholder="0" value="0" required><br>

                <label for="addagi">AGI+:</label>
                <input type="number" id="addagi" placeholder="0" value="0" required><br>

                <label for="addcd">cd固定値:</label>
                <input type="number" id="addcd" placeholder="0" value="0" required><br>

                <label for="cdp">cd%:</label>
                <input type="number" id="cdp" placeholder="0" value="0" required><br>

                <label for="cupslv">クリティカルupslv</label>
                <select id="cupslv">
                    <option value="0">0</option>
                    <option value="1">1</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5</option>
                    <option value="6">6</option>
                    <option value="7">7</option>
                    <option value="8">8</option>
                    <option value="9">9</option>
                    <option value="10">10</option>
                </select><br>

                <label for="kisekislv">神速の軌跡slv:</label>
                <select id="kisekislv">
                    <option value="0">0</option>
                    <option value="1">1</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5</option>
                    <option value="6">6</option>
                    <option value="7">7</option>
                    <option value="8">8</option>
                    <option value="9">9</option>
                    <option value="10">10</option>
                </select><br>

                <button type="button" onclick="calculateCD()">計算</button>
            </form>
            <div id="cdResult" class="result"></div>
        </div>
    </div>

    <!-- フリークリスタ計算 -->
    <div id="freecrystalPage" class="page">
        <h1>フリークリスタ計算</h1>
        <div class="calculator">
            <h2>1. タダになる個数から売値を計算</h2>
            <div>
                <label for="n1">買った単価 (万円):</label>
                <input type="number" id="n1" step="0.1" min="0">
            </div>
            <div>
                <label for="m1">購入個数:</label>
                <input type="number" id="m1" min="0">
            </div>
            <div>
                <label for="t1">タダにしたい個数:</label>
                <input type="number" id="t1" min="0">
            </div>
            <button onclick="calculateStock1()">計算</button>
            <div id="stockResult1" class="result"></div>
        </div>
        <div class="calculator">
            <h2>2. 売却個数から残りのタダになる個数を計算</h2>
            <div>
                <label for="n2">買った単価 (万円):</label>
                <input type="number" id="n2" step="0.1" min="0">
            </div>
            <div>
                <label for="m2">購入個数:</label>
                <input type="number" id="m2" min="0">
            </div>
            <div>
                <label for="k2">売却する個数:</label>
                <input type="number" id="k2" min="0">
            </div>
            <button onclick="calculateStock2()">計算</button>
            <div id="stockResult2" class="result"></div>
        </div>
    </div>

    <!-- c率計算機 -->
    <div id="critsPage" class="page">
        <h1>c率計算機</h1>
        <div class="calculator">
            <form>
                <label for="crt">ステcrt:</label>
                <input type="number" id="crt" placeholder="0" value="0" required><br>
                <label for="crp">c%:</label>
                <input type="number" id="crp" placeholder="0" value="0" required><br>
                <label for="addcr">c固定値:</label>
                <input type="number" id="addcr" placeholder="0" value="0" required><br>
                <label for="addcra">c固定値:</label>
                <input type="number" id="addcra" placeholder="0" value="0" required><br>
                <label for="addcrb">c固定値:</label>
                <input type="number" id="addcrb" placeholder="0" value="0" required><br>
                <label for="addcrc">c固定値:</label>
                <input type="number" id="addcrc" placeholder="0" value="0" required><br>
                <label for="addcrd">c固定値:</label>
                <input type="number" id="addcrd" placeholder="0" value="0" required><br>
                <button type="button" onclick="calculateCrits()">計算</button>
            </form>
            <div id="critsResult" class="result"></div>
        </div>
    </div>

    <!-- マケ計算機 -->
    <div id="makePage" class="page">
        <h1>マケ計算機</h1>
        <div class="calculator">
            <h2>表示値段計算機</h2>
            <label for="s">設定値段:</label>
            <input type="number" id="s" name="s"><br>
            <label for="m">マケ手数料 (%):</label>
            <input type="number" id="m" name="m" step="0.01"><br>
            <button onclick="calculateDisplay()">計算</button>
            <div id="displayResult" class="result"></div>
        </div>
        <div class="calculator">
            <h2>設定値段計算機</h2>
            <label for="hyouki">表記値段:</label>
            <input type="number" id="hyouki" name="hyouki"><br>
            <label for="tesuu">マケ手数料 (%):</label>
            <input type="number" id="tesuu" name="tesuu" step="0.01"><br>
            <button onclick="calculateSetting()">計算</button>
            <div id="settingResult" class="result"></div>
        </div>
        <p>上がマケに表記される値段を計算出来る<br>下がマケにこの値段で出したいを出せる</p>
    </div>

    <script>
        function showPage(pageId) {
            const pages = document.getElementsByClassName('page');
            for (let i = 0; i < pages.length; i++) {
                pages[i].classList.remove('active');
            }
            document.getElementById(pageId).classList.add('active');
        }

        // ダークモード切り替え機能
        const darkModeSwitch = document.getElementById('darkModeSwitch');
        darkModeSwitch.addEventListener('change', () => {
            document.body.classList.toggle('dark-mode');
        });

        // CD計算機関数
        function calculateCD() {
            var basestr = parseFloat(document.getElementById('basestr').value) || 0;
            var strp = parseFloat(document.getElementById('strp').value) || 0;
            var addstr = parseFloat(document.getElementById('addstr').value) || 0;
            var baseagi = parseFloat(document.getElementById('baseagi').value) || 0;
            var agip = parseFloat(document.getElementById('agip').value) || 0;
            var addagi = parseFloat(document.getElementById('addagi').value) || 0;
            var cdp = parseFloat(document.getElementById('cdp').value) || 0;
            var addcd = parseFloat(document.getElementById('addcd').value) || 0;
            var cupslv = parseFloat(document.getElementById('cupslv').value) || 0;
            var kisekislv = parseFloat(document.getElementById('kisekislv').value) || 0;

            cdp += calculatecdupEffect(cupslv);
            var totalagi = baseagi * (1 + agip / 100) + addagi + calculateSwiftTrajectoryEffect(kisekislv);
            var totalstr = basestr * (1 + strp / 100) + addstr;
            var maxResult = Math.max(totalstr / 5, (totalagi + totalstr) / 10);
            var result = Math.floor((150 + maxResult) * (1 + cdp / 100)) + addcd;

            if (result > 300) {
                result = Math.floor((result - 300) / 2 + 300);
            }
            document.getElementById('cdResult').innerText = '結果: ' + result;
        }

        function calculatecdupEffect(level) {
            return Math.min((level - 1), 5);
        }

        function calculateSwiftTrajectoryEffect(level) {
            if (level <= 5) {
                return level;
            } else {
                return 5 + (level - 5) * 2;
            }
        }

        // フリークリスタ計算関数
        function calculateStock1() {
            const n = parseFloat(document.getElementById('n1').value);
            const m = parseInt(document.getElementById('m1').value);
            const t = parseInt(document.getElementById('t1').value);

            if (isNaN(n) || isNaN(m) || isNaN(t) || n <= 0 || m <= 0 || t < 0 || t >= m) {
                document.getElementById('stockResult1').textContent = '正しい値を入力してください。';
                return;
            }

            const totalCost = n * m;
            const j = totalCost / (m - t);

            document.getElementById('stockResult1').textContent = `${j.toFixed(1)}万円で売れば、${t}個がタダになります。`;
        }

        function calculateStock2() {
            const n = parseFloat(document.getElementById('n2').value);
            const m = parseInt(document.getElementById('m2').value);
            const k = parseInt(document.getElementById('k2').value);

            if (isNaN(n) || isNaN(m) || isNaN(k) || n <= 0 || m <= 0 || k <= 0 || k > m) {
                document.getElementById('stockResult2').textContent = '正しい値を入力してください。';
                return;
            }

            const totalCost = n * m;
            const freeItems = m - k;
            const r = totalCost / k;

            document.getElementById('stockResult2').textContent = `${r.toFixed(1)}万円で売れば、残りの${freeItems}個がタダになります。`;
        }

        // c率計算関数
        function calculateCrits() {
            var crt = parseFloat(document.getElementById('crt').value) || 0;
            var crp = parseFloat(document.getElementById('crp').value) || 0;
            var addcr = parseFloat(document.getElementById('addcr').value) || 0;
            var addcra = parseFloat(document.getElementById('addcra').value) || 0;
            var addcrb = parseFloat(document.getElementById('addcrb').value) || 0;
            var addcrc = parseFloat(document.getElementById('addcrc').value) || 0;
            var addcrd = parseFloat(document.getElementById('addcrd').value) || 0;

            var result = Math.floor((25 + crt / 3.4) * (1 + crp / 100)) + addcr + addcra + addcrb + addcrc + addcrd;
            document.getElementById('critsResult').innerText = '結果: ' + result.toFixed(2);
        }

        // マケ計算機関数
        function calculateDisplay() {
            let s = parseFloat(document.getElementById('s').value);
            let m = parseFloat(document.getElementById('m').value);
            if (isNaN(s) || isNaN(m)) {
                alert('有効な数値を入力してください。');
                return;
            }
            let result = s * (1 + m/100);
            document.getElementById('displayResult').textContent = `マケ表記値段: ${result.toFixed(2)}`;
        }

        function calculateSetting() {
            let hyouki = parseFloat(document.getElementById('hyouki').value);
            let tesuu = parseFloat(document.getElementById('tesuu').value);
            if (isNaN(hyouki) || isNaN(tesuu)) {
                alert('有効な数値を入力してください。');
                return;
            }
            let result = hyouki / (1 + tesuu/100);
            document.getElementById('settingResult').textContent = `設定値段: ${result.toFixed(2)}`;
        }

        // 初期表示
        showPage('cdPage');
    </script>
</body>
</html>
